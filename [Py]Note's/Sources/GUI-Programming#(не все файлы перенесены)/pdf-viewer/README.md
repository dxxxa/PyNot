# How to Make a GUI PDF Viewer in Python](https://www.thepythoncode.com/article/make-pdf-viewer-with-tktinter-in-python)
##
# [[] / []]()
PDF - это аббревиатура, которая расшифровывается как portable document format, она была создана Adobe и в мире документов зарекомендовала себя как простой и надежный способ обмена документами. В этом уроке мы создадим средство просмотра PDF с графическим интерфейсом пользователя (GUI), мы рассмотрим такие темы, как проектирование графического интерфейса, интеллектуальный анализ данных PDF и отображение PDF в приложении.

Создание собственного средства просмотра PDF с графическим интерфейсом - отличный способ освоить некоторые из интересных концепций Python, этот учебник об этом, и если вы взволнованы, давайте сразу в него перейдем. Мы будем использовать модуль Tkinter для графического интерфейса пользователя, а для выполнения операций с PDF-файлами, таких как получение метаданных, страницы и текста, мы будем использовать модуль fitz, который является частью модуля PyMuPDF.

Вот что мы собираемся построить в конце этого учебника:



Это приложение будет построено с нуля, и будет подробное освещение концепций, чтобы вы все поняли.

Если вам интересно, что это за PDF-документ, это бесплатная глава нашей электронной книги «Этический взлом с Python»!

Вот оглавление:

Начало работы
Импорт всех необходимых модулей
Создание класса приложения
Объявление необходимых переменных в классе
Проектирование графического интерфейса пользователя
Создание главного окна и добавление значка
Добавление меню в главное окно
Создание верхней и нижней рам
Создание вертикальных и горизонтальных полос прокрутки
Добавление холста в верхний фрейм и настройка полос прокрутки
Добавление кнопок «Вверх», «Вниз» и «Метки» в нижнюю рамку
Реализация функциональности закрывающего приложения
Создание файла miner.py
Реализация функциональных возможностей приложения
Открытие PDF-файла
Отображаемая страница
Следующая страница
Предыдущая страница
Заключение
Начало работы
Начнем с установки необходимых модулей, к счастью, нам нужно будет установить один модуль для этого проекта, остальные модули предустановлены. Поэтому в вашем терминале введите эту команду:

$ pip install pymupdf
Связанные с: Как извлечь текст из PDF на Python.

Импорт всех необходимых модулей
Теперь давайте создадим файл Python и назовем его pdfviewer.py, здесь вы можете назвать файл любым именем, которое вы предпочитаете, но имя должно быть осмысленным. Откройте файл и добавьте следующий код:

# importing everything from tkinter
from tkinter import *
# importing ttk for styling widgets from tkinter
from tkinter import ttk
# importing filedialog from tkinter
from tkinter import filedialog as fd
# importing os module
import os
Мы импортируем все функции и встроенные модули из модуля tkinter, а вторая строка импортирует ttk из tkinter, это для стилизации виджетов (Buttons, Labels, Entries и т.д.). Третья строка кода импортирует filedialog из tkinter снова как fd и в последней строке мы импортируем модуль os, это поможет нам получить текущий рабочий каталог и извлечь PDF-файл из пути.

Создание класса приложения
Мы будем использовать объектно-ориентированный подход к программированию для сборки этого приложения. Теперь, когда импорт выполнен, давайте создадим класс для приложения, под импортом вставьте этот код:

# creating a class called PDFViewer
class PDFViewer:
    # initializing the __init__ / special method
    def __init__(self, master):
        pass
Фрагмент кода создает класс PDFViewer, а внутри него у нас есть конструктор или функция __init__(), аргументы которой являются self и master. Здесь стоит упомянуть, что каждая функция внутри класса принимает себя в качестве первого аргумента. Внутри конструктора мы ничего не делаем через оператор pass на данный момент. Чтобы протестировать программу, вставьте следующий код под класс PDFViewer:

# creating the root window using Tk() class
root = Tk()
# instantiating/creating object app for class PDFViewer
app = PDFViewer(root)
# calling the mainloop to run the app infinitely until user closes it
root.mainloop()
Здесь мы создаем корневое окно с помощью встроенного класса tkinter Tk(), затем создаем объект, аргументом которого является корень главного окна. Обратите внимание, что передаваемый корень заменит мастер внутри конструктора, и, наконец, мы запускаем главное окно бесконечно, пока оно не будет закрыто пользователем.

Чтобы запустить программу, введите в терминале следующую команду:

$ python pfdviewer.py
Если вы используете расширенный редактор, такой как vs code или pycharm, они поставляются с функцией для запуска скриптов Python.

Результаты будут следующими:



Вывод - это просто базовое окно, не беспокойтесь об этом мы будем работать над ним только через мгновение.

Объявление необходимых переменных в классе
Теперь объявим переменные, которые мы будем использовать в приложении, внутри конструктора вставим следующие строки кода:

        # path for the pdf doc
        self.path = None
        # state of the pdf doc, open or closed
        self.fileisopen = None
        # author of the pdf doc
        self.author = None
        # name for the pdf doc
        self.name = None
        # the current page for the pdf
        self.current_page = 0
        # total number of pages for the pdf doc
        self.numPages = None
В фрагменте кода мы объявили следующие переменные:

self.path – это путь к PDF-документу, для которого в настоящее время установлено значение Нет.
self.fileisopen – состояние документа, открытого или закрытого, в настоящее время имеет значение Нет.
self.author – автор документа, в настоящее время задано значение None.
self.name — имя документа, в настоящее время заданное значение None.
self.current_page – текущая страница, в настоящее время установленная на 0.
self.numPages – общее количество страниц, в настоящее время установленное значение None.
Вышеуказанные переменные начнут иметь смысл в тот момент, когда мы начнем их использовать.

Проектирование графического интерфейса пользователя
В этом разделе мы разработаем графический интерфейс для приложения, сосредоточимся на улучшении внешнего вида базового окна, которое мы только что увидели.

Создание главного окна и добавление значка
Теперь внутри конструктора замените инструкцию pass следующим кодом:

        # creating the window
        self.master = master
        # gives title to the main window
        self.master.title('PDF Viewer')
        # gives dimensions to main window
        self.master.geometry('580x520+440+180')
        # this disables the minimize/maximize button on the main window
        self.master.resizable(width = 0, height = 0)
        # loads the icon and adds it to the main window
        self.master.iconbitmap(self.master, 'pdf_file_icon.ico')
Мы создаем мастер главного окна, затем даем ему заголовок через функцию title().

Для управления размерами окна мы используем функцию geometry(), которая принимает 580 как ширину и 520 как высоту, для позиционирования окна вертикально у нас есть 440, а по горизонтали у нас есть 180.

С размерами, установленными для окна, мы делаем его неизменяемым с помощью функции resizable(), как ширина, так и высота установлены в 0. Наконец, мы загрузили и добавили иконку в главное окно с помощью функции iconbitmap().

С приведенным выше кодом мы получим следующий вывод:



В левом верхнем углу главного окна у нас есть значок и заголовок:



Здесь просто убедитесь, что значок находится в той же папке, что и файл программы.

Добавление меню в главное окно
Теперь давайте добавим строку меню в главное окно, это меню будет иметь две кнопки, кнопку Открыть файл и кнопку Выход. Чуть ниже кода главного окна вставьте этот код:

        # creating the menu
        self.menu = Menu(self.master)
        # adding it to the main window
        self.master.config(menu=self.menu)
        # creating a sub menu
        self.filemenu = Menu(self.menu)
        # giving the sub menu a label
        self.menu.add_cascade(label="File", menu=self.filemenu)
        # adding a two buttons to the sub menus
        self.filemenu.add_command(label="Open File")
        self.filemenu.add_command(label="Exit")
Мы создаем строку меню с помощью функции Menu(), аргументом которой является главное окно, а для добавления строки меню в главное окно мы используем функцию config().

Чтобы создать меню файла, мы используем ту же функцию Menu(), а чтобы добавить ее в строку меню, мы используем функцию add_cascade(), которая принимает метку и меню в качестве аргументов. Теперь для добавления подменю в главное меню мы используем функцию add_command(), которая также принимает метку в качестве аргумента, в нашем случае у нас есть два подменю, Open File и Exit.

Запустив программу, мы получим такой вывод:



Если нажать кнопку Файл, два подменю свернуты, чтобы их можно было щелкнуть. Обратите внимание, что подменю являются кнопками, и они также могут принимать аргумент команды.

Создание верхней и нижней рам
Давайте перейдем к созданию двух фреймов, верхнего и нижнего. Внутри верхней рамки у нас будет холст для отображения страниц PDF, а внутри нижнего фрейма у нас будет кнопка вверх и вниз и метка для отображения номера страницы. Поэтому под меню добавьте этот код:

        # creating the top frame
        self.top_frame = ttk.Frame(self.master, width=580, height=460)
        # placing the frame using inside main window using grid()
        self.top_frame.grid(row=0, column=0)
        # the frame will not propagate
        self.top_frame.grid_propagate(False)
        # creating the bottom frame
        self.bottom_frame = ttk.Frame(self.master, width=580, height=50)
        # placing the frame using inside main window using grid()
        self.bottom_frame.grid(row=1, column=0)
        # the frame will not propagate
        self.bottom_frame.grid_propagate(False)
Во фрагменте кода мы создаем два фрейма, верхний и нижний, используя ttk. Функция Frame(). Мы добавляем верхнюю рамку в главное окно, придавая ей высоту и ширину 580 и 460, и помещаем ее в 0-й ряд и столбец.

То же самое с нижней рамой, мы добавляем ее в главное окно, даем ей высоту 580 и ширину 50, и помещаем в 1-й ряд и 0-й столбец. Если вы заметили, что оба этих фрейма имеют функцию grid_progagate(), входные данные которой имеют значение False, это поможет фреймам принять определенный размер независимо от содержимого.

Создание вертикальных и горизонтальных полос прокрутки
В этом разделе мы создадим вертикальные и горизонтальные полосы прокрутки, это поможет нам просмотреть страницу PDF в случае, если она больше, чем холст дисплея. Поэтому под кодом фреймов вставьте этот код:

        # creating a vertical scrollbar
        self.scrolly = Scrollbar(self.top_frame, orient=VERTICAL)
        # adding the scrollbar
        self.scrolly.grid(row=0, column=1, sticky=(N,S))
        # creating a horizontal scrollbar
        self.scrollx = Scrollbar(self.top_frame, orient=HORIZONTAL)
        # adding the scrollbar
        self.scrollx.grid(row=1, column=0, sticky=(W, E))
Мы создаем две полосы прокрутки внутри верхнего фрейма, первая полоса прокрутки имеет вертикальный ориентир, а второй горизонтальный. И используя grid(), мы помещаем вертикальную полосу прокрутки в 0-ю строку и 1-й столбец и, наконец, придерживаемся ее в направлениях N и S. Горизонтальная полоса прокрутки размещается в 1-й строке и 0-м столбце, а также в направлениях W и E.

Добавление холста в верхний фрейм и настройка его полос прокрутки
Теперь давайте создадим Canvas для отображения страниц и добавим его в верхний фрейм, затем мы настроим полосы прокрутки на Canvas. Под полосами прокрутки вставим следующие строки кода:

        # creating the canvas for display the PDF pages
        self.output = Canvas(self.top_frame, bg='#ECE8F3', width=560, height=435)
        # inserting both vertical and horizontal scrollbars to the canvas
        self.output.configure(yscrollcommand=self.scrolly.set, xscrollcommand=self.scrollx.set)
        # adding the canvas
        self.output.grid(row=0, column=0)
        # configuring the horizontal scrollbar to the canvas
        self.scrolly.configure(command=self.output.yview)
        # configuring the vertical scrollbar to the canvas
        self.scrollx.configure(command=self.output.xview)
Здесь с помощью функции Canvas() мы создаем Canvas внутри верхней рамки, мы придаем ему некоторый цвет фона, ширину 560 и высоту 435. Чтобы вставить полосы прокрутки в Canvas, мы используем функцию configure(), которая принимает вертикальные и горизонтальные полосы прокрутки в качестве аргументов. Затем мы помещаем Canvas в 0-ю строку и столбец с помощью функции grid().

Теперь, чтобы отобразить эти полосы прокрутки на Canvas, мы снова используем функцию configure(), она принимает команду, значение которой является видом направления холста, для вертикальной полосы прокрутки у нас есть self.output.yview, а для горизонтальной полосы прокрутки у нас есть self.output.xview

Если мы запустим программу, то получим следующие выходные данные:



Полосы прокрутки были добавлены в Canvas, на данный момент они отключены, так как у нас нет содержимого внутри Canvas.

Добавление кнопок «Вверх», «Вниз» и «Метки» в нижнюю рамку
Теперь, когда виджеты в верхнем фрейме позаботились, давайте добавим виджеты в нижнем фрейме, под этой строкой кода:

        # configuring the vertical scrollbar to the canvas
        self.scrollx.configure(command=self.output.xview)
Добавьте следующий код:

        # loading the button icons
        self.uparrow_icon = PhotoImage(file='uparrow.png')
        self.downarrow_icon = PhotoImage(file='downarrow.png')
        # resizing the icons to fit on buttons
        self.uparrow = self.uparrow_icon.subsample(3, 3)
        self.downarrow = self.downarrow_icon.subsample(3, 3)
        # creating an up button with an icon
        self.upbutton = ttk.Button(self.bottom_frame, image=self.uparrow)
        # adding the button
        self.upbutton.grid(row=0, column=1, padx=(270, 5), pady=8)
        # creating a down button with an icon
        self.downbutton = ttk.Button(self.bottom_frame, image=self.downarrow)
        # adding the button
        self.downbutton.grid(row=0, column=3, pady=8)
        # label for displaying page numbers
        self.page_label = ttk.Label(self.bottom_frame, text='page')
        # adding the label
        self.page_label.grid(row=0, column=4, padx=5)
С помощью этого фрагмента кода мы загружаем два значка для кнопок с помощью функции PhotoImage(), а затем изменяем размер значков, чтобы они правильно помещались внутри кнопок. Для создания кнопок мы используем ttk. Функция Button(), которая принимает нижний кадр и изображение в качестве аргументов.

Для первой кнопки через grid() мы помещаем ее в 0-ю строку и 1-й столбец, чтобы нажать на нее в центр, мы используем padx=(270, 5), а для нажатия на нее 8 пикселей по горизонтали мы используем pady=8.

Для второй кнопки, используя grid(), мы снова помещаем ее в 0-ю строку и 3-й столбец, и она также занимает 8 пикселей по горизонтали.

Наконец, мы создаем метку для отображения количества страниц, помещаем ее в одну строку с кнопками.

Давайте посмотрим, как выглядит приложение:



Добавлены две кнопки и метка, как упоминалось ранее, все значки приложения должны находиться в той же папке, что и файл программы.